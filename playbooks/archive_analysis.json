{
    "name": "archive_analysis",
    "description": "Archive Analysis (Deep Recursion) - Extract and analyze archives",
    "file_types": [
        "zip",
        "tar",
        "gzip",
        "bzip2",
        "7z",
        "rar"
    ],
    "steps": [
        {
            "name": "Universal Extract (7z)",
            "description": "Try extracting with 7zip (handles most formats)",
            "command": "7z x {target} -ooutput/_extracted/ -y",
            "parse_output": false,
            "continue_on_error": true
        },
        {
            "name": "Search Extracted Files for Flags",
            "description": "Run strings on all extracted files and search for flags",
            "command": "find output/_extracted/ -type f -exec strings {} \\; 2>/dev/null | grep -iE '(picoCTF|flag\\{|FLAG\\{|CTF\\{)'",
            "parse_output": true,
            "continue_on_error": true
        },
        {
            "name": "Recursive Grep",
            "description": "Search for flags in all extracted files",
            "command": "grep -r -iE '(picoCTF|flag|CTF)' output/_extracted/ 2>/dev/null",
            "parse_output": true,
            "continue_on_error": true
        }
    ],
    "flag_patterns": [
        "picoCTF\\{[^}]+\\}",
        "flag\\{[^}]+\\}",
        "FLAG\\{[^}]+\\}",
        "CTF\\{[^}]+\\}"
    ]
}